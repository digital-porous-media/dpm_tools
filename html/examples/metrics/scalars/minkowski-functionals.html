
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Minkowski Functionals &#8212; DPM_Tools  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/metrics/scalars/minkowski-functionals';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Map Metrics" href="../../../tutorials/metrics/maps.html" />
    <link rel="prev" title="Heterogeneity Classifier" href="heterogeneity-classifier.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">DPM_Tools  documentation</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../getting-started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../modules/index.html">
    Modules
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/digital-porous-media/dpm_tools/issues">
    Issue Tracker
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/digital-porous-media/dpm_tools" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../getting-started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../modules/index.html">
    Modules
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/digital-porous-media/dpm_tools/issues">
    Issue Tracker
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/digital-porous-media/dpm_tools" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../tutorials/general/index.html">Quick Start</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../quick_start.html"><strong>Quick Start Guide</strong></a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../../tutorials/metrics/index.html">Metrics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../../../tutorials/metrics/scalars.html">Scalar Metrics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="heterogeneity-classifier.html">Heterogeneity Classifier</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Minkowski Functionals</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../tutorials/metrics/maps.html">Map Metrics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../maps/distance_transforms.html">Distance Transforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/ellipse_area.html">Ellipse Area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/maximum_inscribed_sphere.html">Maximum Inscribed Spheres</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/minkowski_map.html">Minkowski Maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/morphological_drainage.html">Morphological Drainage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../maps/time_of_flight.html">Time of Flight</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../tutorials/segmentation/index.html">Segmentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../segmentation/seeded_region_growing.html">Seeded Region Growing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../segmentation/statistical_region_merging.html">Statistical Region Merging</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../tutorials/visualization/index.html">Visualization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/3D_visualization.html">3D Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/competent_subset.html">Finding Competent Subsets for Visualization and Simulation</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../../tutorials/index.html" class="nav-link">Tutorials</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../../tutorials/metrics/index.html" class="nav-link">Metrics</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../../tutorials/metrics/scalars.html" class="nav-link">Scalar Metrics</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Minkowski Functionals</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="minkowski-functionals">
<h1>Minkowski Functionals<a class="headerlink" href="#minkowski-functionals" title="Link to this heading">#</a></h1>
<p>This notebook demonstrates some methods of computing the four Minkowski functionals (in 3D). The four Minkowski functionals are:</p>
<ol class="arabic simple">
<li><p>Volume</p></li>
<li><p>Surface Area</p></li>
<li><p>Integral Mean Curvature</p></li>
<li><p>Euler Characteristic</p></li>
</ol>
<hr class="docutils" />
<p>In this notebook, we compare Minkowski functional calculations via 2 methods:</p>
<ul class="simple">
<li><p>Counts arrangements of <span class="math notranslate nohighlight">\(2^3\)</span> neighborhoods of voxels using DPM Tools</p></li>
<li><p>Creates a mesh using <a class="reference external" href="https://scikit-image.org/">Scikit-Image</a>, <a class="reference external" href="https://trimesh.org/">Trimesh</a>, and <a class="reference external" href="https://porespy.org/">Porespy</a></p></li>
</ul>
<section id="import-some-packages">
<h2>Import some packages<a class="headerlink" href="#import-some-packages" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Some Utility functions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># Image processsing</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">skimage</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">skimage.morphology</span><span class="w"> </span><span class="kn">import</span> <span class="n">ball</span>

<span class="c1"># Image visualization</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvista</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pv</span>
<span class="n">pv</span><span class="o">.</span><span class="n">set_jupyter_backend</span><span class="p">(</span><span class="s1">&#39;static&#39;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.gridspec</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSpec</span>

<span class="c1"># Image quantification</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">porespy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ps</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">trimesh</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dpm_tools.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_image</span><span class="p">,</span> <span class="n">Image</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dpm_tools.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">minkowski_functionals</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dpm_tools.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_isosurface</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #7fbfbf; text-decoration-color: #7fbfbf">[21:29:20] </span><span style="color: #800000; text-decoration-color: #800000; font-weight: bold">ERROR   </span> PARDISO solver not installed, run `pip install pypardiso`. Otherwise,          <a href="file:///opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/openpnm/utils/_workspace.py" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">_workspace.py</span></a><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">:</span><a href="file:///opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/openpnm/utils/_workspace.py#56" target="_blank"><span style="color: #7f7f7f; text-decoration-color: #7f7f7f">56</span></a>
<span style="color: #7fbfbf; text-decoration-color: #7fbfbf">           </span>         simulations will be slow. Apple M chips not supported.                         <span style="color: #7f7f7f; text-decoration-color: #7f7f7f">                </span>
</pre>
</div></div>
</div>
</section>
<section id="computing-the-minkowski-functionals">
<h2>1. Computing the Minkowski Functionals<a class="anchor" id="chapter1"></a><a class="headerlink" href="#computing-the-minkowski-functionals" title="Link to this heading">#</a></h2>
<p>For the following introductory demonstrations, we will use a single solid sphere sample as the motivating example. At the end, we will have the opportunity to try the functions on the other samples.</p>
<p>Generally speaking, the Minkowski functionals can be computed using voxel methods or mesh methods. We will explore both here using the Quantimpy (voxelized) and the Trimesh/Skimage (mesh) libraries.</p>
<p><strong>In the following cell, we create and visualize a solid sphere of radius 100 voxels</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radius</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">side_length</span> <span class="o">=</span> <span class="mi">250</span>

<span class="n">sphere</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">side_length</span><span class="p">,</span> <span class="n">side_length</span><span class="p">,</span> <span class="n">side_length</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">id_a</span> <span class="o">=</span> <span class="n">side_length</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">radius</span>
<span class="n">id_b</span> <span class="o">=</span> <span class="n">side_length</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">radius</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">sphere</span><span class="p">[</span><span class="n">id_a</span><span class="p">:</span><span class="n">id_b</span><span class="p">,</span> <span class="n">id_a</span><span class="p">:</span><span class="n">id_b</span><span class="p">,</span> <span class="n">id_a</span><span class="p">:</span><span class="n">id_b</span><span class="p">]</span> <span class="o">=</span> <span class="n">ball</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># DPM Tools Image object</span>
<span class="n">sphere</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">scalar</span><span class="o">=</span><span class="n">sphere</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Before we begin, we create a function to compare our package computations with the analytical solution</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">analytical_solution</span><span class="p">(</span><span class="n">radius</span><span class="p">):</span>
    <span class="n">volume_analytical</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">radius</span><span class="o">**</span><span class="mi">3</span>
    <span class="n">surface_area_analytical</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">mean_curvature_analytical</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">radius</span>
    <span class="n">euler_analytical</span> <span class="o">=</span> <span class="mf">1.0</span>
    
    <span class="k">return</span> <span class="n">volume_analytical</span><span class="p">,</span> <span class="n">surface_area_analytical</span><span class="p">,</span> <span class="n">mean_curvature_analytical</span><span class="p">,</span> <span class="n">euler_analytical</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_error</span><span class="p">(</span><span class="n">true</span><span class="p">,</span> <span class="n">computed_measures</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">true</span> <span class="o">-</span> <span class="n">compute</span><span class="p">)</span> <span class="o">/</span> <span class="n">true</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span> <span class="k">for</span> <span class="n">compute</span> <span class="ow">in</span> <span class="n">computed_measures</span><span class="p">]</span>

<span class="n">volume_analytical</span><span class="p">,</span> <span class="n">surface_area_analytical</span><span class="p">,</span> <span class="n">mean_curvature_analytical</span><span class="p">,</span> <span class="n">euler_analytical</span> <span class="o">=</span> <span class="n">analytical_solution</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="volume-calculation">
<h3>1.1 Volume Calculation<a class="headerlink" href="#volume-calculation" title="Link to this heading">#</a></h3>
<p>Considering a 3D body, <span class="math notranslate nohighlight">\(X\)</span>, with a smooth boundary, <span class="math notranslate nohighlight">\(\delta X\)</span>, the first Minkowski functional (volume) can be computed as:</p>
<div class="math notranslate nohighlight">
\[ M_0(X) = \int_X dv \]</div>
<p>For a sphere, the volume can be found as:</p>
<div class="math notranslate nohighlight">
\[ M_0 = \frac{4}{3} \pi R^3 \]</div>
<p>In practice, volume is the most straightforward of the Minkowski functionals set to compute.</p>
<p>Here, we compare a few different methods and packages for computing the volume of the pore space, split into voxelized methods and mesh methods:</p>
<ol class="arabic simple">
<li><p>Voxel Counting</p></li>
<li><p>Quantimpy (Voxelized)</p></li>
<li><p>Trimesh (Mesh)</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_volume</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="c1"># Simple voxel counting</span>
    <span class="n">voxel_counting</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">image</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># DPM Tools</span>
    <span class="n">dpm_tools_volume</span> <span class="o">=</span> <span class="n">minkowski_functionals</span><span class="p">(</span><span class="n">image</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># Mesh Volume</span>
    <span class="n">mesh_measures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">mesh_volume</span><span class="p">(</span><span class="n">image</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">voxel_counting</span><span class="p">,</span> <span class="n">dpm_tools_volume</span><span class="p">,</span> <span class="n">mesh_measures</span>

<span class="n">volume_measures</span> <span class="o">=</span> <span class="n">compute_volume</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">scalar</span><span class="p">)</span>
<span class="n">volume_errors</span> <span class="o">=</span> <span class="n">compute_error</span><span class="p">(</span><span class="n">volume_analytical</span><span class="p">,</span> <span class="n">volume_measures</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Volume Calculations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Analytical Solution: </span><span class="si">{</span><span class="n">volume_analytical</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Voxel Counting: </span><span class="si">{</span><span class="n">volume_measures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> Rel. Error: </span><span class="si">{</span><span class="n">volume_errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">DPM Tools: </span><span class="si">{</span><span class="n">volume_measures</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> Rel. Error: </span><span class="si">{</span><span class="n">volume_errors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Mesh: </span><span class="si">{</span><span class="n">volume_measures</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\t\t</span><span class="s2"> Rel. Error: </span><span class="si">{</span><span class="n">volume_errors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Volume Calculations:
	Analytical Solution: 4188790.205
	Voxel Counting: 4187857.000 	 Rel. Error: 0.022%
	DPM Tools: 4187857.000 	 Rel. Error: 0.022%
	Mesh: 4187199.480 		 Rel. Error: 0.038%
</pre></div>
</div>
</div>
</div>
</section>
<section id="surface-calculation">
<h3>1.2 Surface Calculation<a class="headerlink" href="#surface-calculation" title="Link to this heading">#</a></h3>
<p>The second Minkowski functional (surface area) can be computed as:</p>
<div class="math notranslate nohighlight">
\[ M_1(X) = \int_{\delta X} ds \]</div>
<p>For a sphere, the surface area can be found as:</p>
<div class="math notranslate nohighlight">
\[ M_1 = 4 \pi R^2 \]</div>
<p>Again, there are multiple ways to compute the surface area of the solid/pore boundary. Here, we compare:</p>
<ol class="arabic simple">
<li><p>Quantimpy (voxelized), and</p></li>
<li><p>Surface Mesh method (Skimage):</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_surface_area</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="c1"># DPM Tools</span>
    <span class="n">dpm_tools_surface_area</span> <span class="o">=</span> <span class="n">minkowski_functionals</span><span class="p">(</span><span class="n">image</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># Mesh Surface Area</span>
    <span class="n">verts</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">normals</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">measure</span><span class="o">.</span><span class="n">marching_cubes</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">level</span> <span class="o">=</span> <span class="n">smoothing</span><span class="p">)</span>
    <span class="n">mesh_surface_area</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">measure</span><span class="o">.</span><span class="n">mesh_surface_area</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">faces</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">dpm_tools_surface_area</span><span class="p">,</span> <span class="n">mesh_surface_area</span>

<span class="c1"># Compute the surface area using 0.5 isosurface</span>
<span class="n">surface_area_measures</span> <span class="o">=</span> <span class="n">compute_surface_area</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">scalar</span><span class="p">)</span>
<span class="n">surface_area_errors</span> <span class="o">=</span> <span class="n">compute_error</span><span class="p">(</span><span class="n">surface_area_analytical</span><span class="p">,</span> <span class="n">surface_area_measures</span><span class="p">)</span>

<span class="c1"># Compute the surface area using some other isosurface</span>
<span class="n">_</span><span class="p">,</span> <span class="n">surface_area_measures_blocky</span> <span class="o">=</span> <span class="n">compute_surface_area</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">scalar</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">:=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">surface_area_errors_blocky</span> <span class="o">=</span> <span class="n">compute_error</span><span class="p">(</span><span class="n">surface_area_analytical</span><span class="p">,</span> <span class="p">[</span><span class="n">surface_area_measures_blocky</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Surface Area Calculations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Analytical Solution: </span><span class="si">{</span><span class="n">surface_area_analytical</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">DPM_Tools: </span><span class="si">{</span><span class="n">surface_area_measures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\t\t</span><span class="s2"> Rel. Error: </span><span class="si">{</span><span class="n">surface_area_errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Mesh (0.5 Isosurface): </span><span class="si">{</span><span class="n">surface_area_measures</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> Rel. Error: </span><span class="si">{</span><span class="n">surface_area_errors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Mesh (</span><span class="si">{</span><span class="n">smoothing</span><span class="si">}</span><span class="s2"> Isosurface): </span><span class="si">{</span><span class="n">surface_area_measures_blocky</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> Rel. Error: </span><span class="si">{</span><span class="n">surface_area_errors_blocky</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Surface Area Calculations:
	Analytical Solution: 125663.706
	DPM_Tools: 125668.000 		 Rel. Error: 0.003%
	Mesh (0.5 Isosurface): 136694.734 	 Rel. Error: 8.778%
	Mesh (0 Isosurface): 137776.469 	 Rel. Error: 9.639%
</pre></div>
</div>
</div>
</div>
</section>
<section id="integral-mean-curvature-calculation">
<h3>1.3 Integral Mean Curvature Calculation<a class="headerlink" href="#integral-mean-curvature-calculation" title="Link to this heading">#</a></h3>
<p>The third Minkowski functional (integral mean curvature area) can be computed as:</p>
<div class="math notranslate nohighlight">
\[ M_2(X) = \int_{\delta X} \frac{1}{2} \left[ \frac{1}{R_1} + \frac{1}{R_2} \right] ds \]</div>
<p>For a sphere, the principal radii of curvature are the same everywhere (i.e. <span class="math notranslate nohighlight">\(R_1 = R_2\)</span>). Therefore, the analytical integral mean curvature can be found as:</p>
<div class="math notranslate nohighlight">
\[ M_2 = 4 \pi R \]</div>
<p>3D curvature measurements are not trivial to compute. Though there are many methods to compute the curvature, we will stick with the built in functions available in Quantimpy and the Trimesh library.</p>
<ol class="arabic simple">
<li><p>Quantimpy (voxelized), and</p></li>
<li><p>Surface Mesh method (Implemented with Trimesh):</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_mean_curvature</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="c1"># Quantimpy</span>
    <span class="n">dpm_tools_mean_curvature</span> <span class="o">=</span> <span class="n">minkowski_functionals</span><span class="p">(</span><span class="n">image</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
    
    <span class="c1"># Mesh Surface Area</span>
    <span class="n">trimesh_sphere</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">creation</span><span class="o">.</span><span class="n">icosphere</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">)</span>
    <span class="n">mesh_mean_curvature</span> <span class="o">=</span> <span class="n">trimesh_sphere</span><span class="o">.</span><span class="n">integral_mean_curvature</span>
    
    <span class="k">return</span> <span class="n">dpm_tools_mean_curvature</span><span class="p">,</span> <span class="n">mesh_mean_curvature</span>

<span class="n">mean_curvature_measures</span> <span class="o">=</span> <span class="n">compute_mean_curvature</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">scalar</span><span class="p">)</span>
<span class="n">mean_curvature_errors</span> <span class="o">=</span> <span class="n">compute_error</span><span class="p">(</span><span class="n">mean_curvature_analytical</span><span class="p">,</span> <span class="n">mean_curvature_measures</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean Calculations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Analytical Solution: </span><span class="si">{</span><span class="n">mean_curvature_analytical</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">DPM Tools: </span><span class="si">{</span><span class="n">mean_curvature_measures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> Rel. Error: </span><span class="si">{</span><span class="n">mean_curvature_errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Mesh: </span><span class="si">{</span><span class="n">mean_curvature_measures</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\t\t</span><span class="s2"> Rel. Error: </span><span class="si">{</span><span class="n">mean_curvature_errors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Calculations:
	Analytical Solution: 1256.637
	DPM Tools: 1262.920 	 Rel. Error: 0.500%
	Mesh: 1254.639 		 Rel. Error: 0.159%
</pre></div>
</div>
</div>
</div>
</section>
<section id="euler-characteristic">
<h3>1.4 Euler Characteristic<a class="headerlink" href="#euler-characteristic" title="Link to this heading">#</a></h3>
<p>The fourth Minkowski functional (Gaussian curvature) can be computed as:</p>
<div class="math notranslate nohighlight">
\[ M_3(X) = \int_{\delta X} \left[ \frac{1}{R_1R_2} \right] ds \]</div>
<p>Because the principal radii of curvature are the same everywhere for a sphere (i.e. <span class="math notranslate nohighlight">\(R_1 = R_2\)</span>), the analytical total curvature can be found as:</p>
<div class="math notranslate nohighlight">
\[ M_3 = 4 \pi\]</div>
<p>The Gauss-Bonnet theorem links the Gaussian Curvature to the Euler characteristic (or Euler number) by:</p>
<div class="math notranslate nohighlight">
\[ 4\pi\chi = M_3(X).\]</div>
<p>So, for a solid ball, the Euler number (<span class="math notranslate nohighlight">\(\chi\)</span>) <span class="math notranslate nohighlight">\(= 1\)</span></p>
<p>Here, we compute the Euler number using:</p>
<ol class="arabic simple">
<li><p>Quantimpy, and</p></li>
<li><p>Skimage</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_euler_number</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="c1"># Quantimpy</span>
    <span class="n">dpm_tools_euler_number</span> <span class="o">=</span> <span class="n">minkowski_functionals</span><span class="p">(</span><span class="n">image</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
    
    <span class="c1"># Mesh Surface Area</span>
    <span class="n">skimage_euler_number</span> <span class="o">=</span> <span class="n">skimage</span><span class="o">.</span><span class="n">measure</span><span class="o">.</span><span class="n">euler_number</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">connectivity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">dpm_tools_euler_number</span><span class="p">,</span> <span class="n">skimage_euler_number</span>

<span class="n">euler_number_measures</span> <span class="o">=</span> <span class="n">compute_euler_number</span><span class="p">(</span><span class="n">sphere</span><span class="o">.</span><span class="n">scalar</span><span class="p">)</span>
<span class="n">euler_number_errors</span> <span class="o">=</span> <span class="n">compute_error</span><span class="p">(</span><span class="n">euler_analytical</span><span class="p">,</span> <span class="n">euler_number_measures</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Euler Number Calculations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Analytical Solution: </span><span class="si">{</span><span class="n">euler_analytical</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">DPM Tools: </span><span class="si">{</span><span class="n">euler_number_measures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> Rel. Error: </span><span class="si">{</span><span class="n">euler_number_errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Skimage: </span><span class="si">{</span><span class="n">euler_number_measures</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\t\t</span><span class="s2"> Rel. Error: </span><span class="si">{</span><span class="n">euler_number_errors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">0.3f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Euler Number Calculations:
	Analytical Solution: 1.000
	DPM Tools: 1.000 	 Rel. Error: 0.000%
	Skimage: 1.000 		 Rel. Error: 0.000%
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="minkowski-functionals-in-rock-samples">
<h2>2. Minkowski Functionals in Rock Samples<a class="headerlink" href="#minkowski-functionals-in-rock-samples" title="Link to this heading">#</a></h2>
<p>In the following cell, we compute the Minkowski functionals for the four samples we previously examined. For sake of simplicity, we will only use the Quantimpy library here.</p>
<section id="loading-in-our-data">
<h3>2.1 Loading in our data<a class="headerlink" href="#loading-in-our-data" title="Link to this heading">#</a></h3>
<p>We load in TIFF images from the data directory. This directory contains segmented x-ray microtomography data from the Network Generation Comparison Forum and is available on the Digital Rocks Portal (https://www.digitalrocksportal.org/projects/16).</p>
<p>For the purposes of this workshop, we have preprocessed the data to be in TIFF file format with solid and pore labeled as 0 and 1, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datapath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../../../_static&#39;</span><span class="p">)</span>
<span class="n">beadpack</span> <span class="o">=</span> <span class="n">read_image</span><span class="p">(</span><span class="n">datapath</span> <span class="o">/</span> <span class="s1">&#39;beadpack.tif&#39;</span><span class="p">)</span>
<span class="n">gambier</span> <span class="o">=</span> <span class="n">read_image</span><span class="p">(</span><span class="n">datapath</span> <span class="o">/</span> <span class="s1">&#39;mtgambier.tif&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Create subplots</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>


<span class="n">im1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">beadpack</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gambier</span><span class="p">[</span><span class="mi">0</span><span class="p">,:,:],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Glass Bead Pack&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mt. Gambier Limestone&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/11f5aaafc50bcdcd05ef1bd4f9caf6f55acdc835ffe1b3c78bffdcf766455d40.png" src="../../../_images/11f5aaafc50bcdcd05ef1bd4f9caf6f55acdc835ffe1b3c78bffdcf766455d40.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_sample_mf</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    
    <span class="n">sample_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Mt. Gambier Limestone&#39;</span><span class="p">:</span> <span class="n">gambier</span><span class="p">,</span> 
                   <span class="s1">&#39;Beadpack&#39;</span><span class="p">:</span> <span class="n">beadpack</span><span class="p">}</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sample_dict</span><span class="p">[</span><span class="n">sample</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
    <span class="n">mfs</span> <span class="o">=</span> <span class="n">minkowski_functionals</span><span class="p">(</span><span class="n">sample_dict</span><span class="p">[</span><span class="n">sample</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Minkowski Functionals:&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Volume: </span><span class="si">{</span><span class="n">mfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Surface Area: </span><span class="si">{</span><span class="n">mfs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Integral Mean Curvature: </span><span class="si">{</span><span class="n">mfs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Euler Number: </span><span class="si">{</span><span class="n">mfs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compute_sample_mf</span><span class="p">(</span><span class="s1">&#39;Beadpack&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Minkowski Functionals:
	Volume: 6356074.000
	Surface Area: 1432277.333
	Integral Mean Curvature: -19064.231
	Euler Number: -1455.500
</pre></div>
</div>
<img alt="../../../_images/29dbab7ecddbdcfd2f8065202340e4f278da0251804461c4d845704fc27d81d5.png" src="../../../_images/29dbab7ecddbdcfd2f8065202340e4f278da0251804461c4d845704fc27d81d5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compute_sample_mf</span><span class="p">(</span><span class="s1">&#39;Mt. Gambier Limestone&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Minkowski Functionals:
	Volume: 7314939.000
	Surface Area: 2163465.333
	Integral Mean Curvature: 118698.795
	Euler Number: -2971.500
</pre></div>
</div>
<img alt="../../../_images/9090fa667579bc1de37afa0d4025642e577d468bd7cb226454b3e56c8e2761d3.png" src="../../../_images/9090fa667579bc1de37afa0d4025642e577d468bd7cb226454b3e56c8e2761d3.png" />
</div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-some-packages">Import some packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-minkowski-functionals">1. Computing the Minkowski Functionals<a class="anchor" id="chapter1"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#volume-calculation">1.1 Volume Calculation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#surface-calculation">1.2 Surface Calculation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integral-mean-curvature-calculation">1.3 Integral Mean Curvature Calculation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#euler-characteristic">1.4 Euler Characteristic</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minkowski-functionals-in-rock-samples">2. Minkowski Functionals in Rock Samples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-in-our-data">2.1 Loading in our data</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Digital Porous Media Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>